c---------------------------------EDGE------------------------------
c
c    This function returns the energy in kev of the absorption
c    edge for the given element.  The data are stored in the lookup
c    table in integer format in ev
c    Source: Handbook of Chemistry and Physics, 63rd Ed., CRC Press.
c    2-feb-88 r.a. waldo
c    Edges > 50000ev are not included.
c
      function edge(j,line)
      integer x0(12,10),x1(12,10),x2(12,10),x3(12,10),x4(12,10),
     &x5(12,10),x6(12,10),x7(12,10),x8(12,10),x9(12,2)
      character*3 line
c     k  l1 l2 l3 m1 m2 m3 m4 m5 n1 n2 n3
      data x0/
     &14, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
     &25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
     &55, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
     &111, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
     &188, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
     &284, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
     &402, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
     &532, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
     &685, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
     &867, 45, 18, 18, 0, 0, 0, 0, 0, 0, 0, 0/
      data x1/
     &1072, 63, 31, 31, 0, 0, 0, 0, 0, 0, 0, 0,
     &1305, 89, 51, 51, 0, 0, 0, 0, 0, 0, 0, 0,
     &1560, 117, 73, 73, 0, 0, 0, 0, 0, 0, 0, 0,
     &1839, 149, 99, 99, 0, 0, 0, 0, 0, 0, 0, 0,
     &2146, 189, 132, 132, 0, 0, 0, 0, 0, 0, 0, 0,
     &2472, 229, 165, 165, 0, 0, 0, 0, 0, 0, 0, 0,
     &2822, 270, 202, 200, 0, 0, 0, 0, 0, 0, 0, 0,
     &3203, 320, 247, 245, 0, 0, 0, 0, 0, 0, 0, 0,
     &3607, 377, 296, 294, 0, 0, 0, 0, 0, 0, 0, 0,
     &4038, 438, 350, 346, 0, 0, 0, 0, 0, 0, 0, 0/
      data x2/
     &4493, 500, 407, 402, 0, 0, 0, 0, 0, 0, 0, 0,
     &4966, 564, 462, 456, 0, 0, 0, 0, 0, 0, 0, 0,
     &5465, 628, 521, 513, 0, 0, 0, 0, 0, 0, 0, 0,
     &5989, 695, 584, 575, 0, 0, 0, 0, 0, 0, 0, 0,
     &6539, 769, 651, 640, 84, 49, 49, 3, 3, 0, 0, 0,
     &7112, 846, 721, 708, 93, 54, 54, 4, 4, 0, 0, 0,
     &7709, 926, 794, 779, 101, 54, 54, 3, 3, 0, 0, 0,
     &8333, 1008, 872, 855, 112, 68, 68, 4, 4, 0, 0, 0,
     &8979, 1096, 951, 931, 120, 74, 74, 2, 2, 0, 0, 0,
     &9659, 1194, 1043, 1020, 136, 87, 87, 8, 8, 0, 0, 0/
      data x3/
     &10367, 1298, 1142, 1115, 158, 107, 103, 17, 17, 0, 0, 0,
     &11103, 1414, 1248, 1217, 180, 128, 121, 29, 29, 0, 0, 0,
     &11867, 1527, 1359, 1323, 204, 146, 141, 41, 41, 3, 3, 3,
     &12658, 1654, 1476, 1433, 232, 168, 162, 57, 57, 6, 6, 6,
     &13474, 1782, 1596, 1550, 257, 189, 182, 70, 69, 27, 5, 5,
     &14326, 1921, 1727, 1675, 289, 223, 214, 89, 89, 24, 11, 11,
     &15200, 2065, 1864, 1804, 322, 247, 239, 112, 110, 29, 15, 14,
     &16105, 2216, 2007, 1940, 358, 280, 269, 135, 133, 38, 20, 20,
     &17038, 2373, 2156, 2080, 394, 312, 300, 160, 157, 45, 26, 26,
     &17998, 2532, 2307, 2222, 430, 344, 331, 182, 180, 51, 29, 29/
      data x4/
     &18986, 2698, 2465, 2371, 468, 378, 363, 207, 205, 58, 34, 34,
     &20000, 2866, 2625, 2520, 505, 410, 392, 230, 227, 62, 35, 35,
     &21044, 3043, 2793, 2677, 544, 445, 425, 256, 253, 68, 39, 39,
     &22117, 3224, 2967, 2838, 585, 483, 461, 284, 279, 75, 43, 43,
     &23220, 3412, 3146, 3004, 627, 521, 496, 312, 307, 81, 48, 48,
     &24350, 3604, 3330, 3173, 670, 559, 532, 340, 335, 86, 51, 51,
     &25514, 3806, 3524, 3351, 718, 602, 571, 373, 367, 95, 63, 56,
     &26711, 4018, 3727, 3538, 770, 651, 617, 411, 404, 108, 67, 67,
     &27940, 4238, 3938, 3730, 826, 702, 664, 451, 443, 122, 77, 77,
     &29200, 4465, 4156, 3929, 884, 756, 714, 493, 485, 137, 89, 89/
      data x5/
     &30491, 4698, 4380, 4132, 944, 812, 766, 537, 528, 152, 98, 98,
     &31814, 4939, 4612, 4341, 1006, 870, 819, 583, 572, 168, 110, 110,
     &33169, 5188, 4852, 4557, 1072, 931, 875, 631, 619, 186, 123, 123,
     &34561, 5453, 5104, 4782, 1143, 999, 937, 685, 672, 208, 147, 147,
     &35985, 5714, 5359, 5012, 1217, 1065, 998, 740, 726, 231, 172, 162,
     &37441, 5989, 5624, 5247, 1293, 1137, 1062, 796, 781, 253,192, 180,
     &38925, 6266, 5891, 5483, 1361, 1204, 1123, 849, 832, 270,206, 191,
     &40443, 6549, 6164, 5723, 1435, 1273, 1185, 901, 883, 290,223, 207,
     &41991, 6835, 6440, 5964, 1511, 1337, 1242, 951, 931, 305,236, 218,
     &43569, 7126, 6722, 6208, 1575, 1403, 1297, 1000, 978, 315,243,224/
      data x6/
     &45184, 7428, 7013, 6459, 1650, 1471, 1357, 1052, 1027,330,242,242,
     &46834, 7737, 7312, 6716, 1723, 1541, 1420, 1106, 1080,346,266,247,
     &48519, 8052, 7617, 6977, 1800, 1614, 1481, 1161, 1131,360,284,257,
     &-1, 8376, 7930, 7243, 1881, 1688, 1544, 1217, 1185, 376, 289, 271,
     &-1, 8708, 8252, 7514, 1968, 1768, 1611, 1275, 1241, 398, 310, 285,
     &-1, 9046, 8581, 7790, 2047, 1842, 1676, 1333, 1295, 416, 332, 293,
     &-1, 9394, 8918, 8071, 2128, 1923, 1741, 1392, 1351, 436, 344, 307,
     &-1, 9751, 9264, 8358, 2207, 2006, 1812, 1453, 1409, 449, 366, 320,
     &-1, 10116, 9617, 8648, 2307, 2090, 1885, 1515, 1468, 472,386, 337,
     &-1, 10486, 9978, 8944, 2398, 2173, 1950, 1576, 1528, 487,397, 344/
      data x7/
     &-1, 10870, 10349, 9244, 2491, 2264, 2024, 1639, 1589, 506,410,359,
     &-1, 11271, 10739, 9561, 2601, 2365, 2108, 1716, 1662, 538,437,380,
     &-1, 11682, 11136, 9881, 2708, 2469, 2194, 1793, 1735, 567,465,405,
     &-1, 12100, 11544, 10207, 2820, 2575, 2281, 1872, 1809,595,492,425,
     &-1, 12527, 11959, 10535, 2932, 2682, 2367, 1949, 1883,625,518,444,
     &-1, 12968, 12385, 10871, 3049, 2792, 2457, 2031, 1960,654,547,468,
     &-1, 13419, 12824, 11215, 3174, 2909, 2551, 2116, 2040,690,577,494,
     &-1, 13880, 13273, 11564, 3296, 3027, 2645, 2202, 2122,722,609,519,
     &-1, 14353, 13734, 11919, 3425, 3148, 2743, 2291, 2206,759,644,545,
     &-1, 14839, 14209, 12284, 3562, 3279, 2847, 2385, 2295,800,677,571/
      data x8/
     &-1, 15347, 14698, 12657, 3704, 3416, 2957, 2485, 2389,846,721,609,
     &-1, 15861, 15200, 13035, 3851, 3554, 3066, 2586, 2484,894,764,645,
     &-1, 16388, 15711, 13419, 3999, 3696, 3177, 2688, 2580,938,805,679,
     &-1, 16939, 16244, 13814, 4149, 3854, 3302, 2798, 2683,995,851,705,
     &-1, 17493, 16785, 14214, 4317, 4008, 3426, 2909,2787,1042,886,740,
     &-1, 18049, 17337, 14619, 4482, 4159, 3538, 3022,2892,1097,929,768,
     &-1, 18639, 17907, 15031, 4652, 4327, 3663, 3136,3000,1153,980,810,
     &-1, 19237, 18484, 15444, 4822, 4490, 3792,3248,3105,1208,1058,879,
     &-1, 19840, 19083, 15871, 5002, 4656, 3909,3370,3219,1269,1080,890,
     &-1, 20472, 19693, 16300, 5182, 4830, 4046,3491,3332,1330,1168,967/
      data x9/
     &-1, 21105, 20314, 16733, 5367, 5001,4174,3611,3442,1387,1224,1007,
     &-1, 21757, 20948, 17166, 5548, 5182,4303,3728,3552,1441,1273,1045/
      if (line(1:1).eq.'K') then
        iedge=1
      else if (line(1:1).eq.'L') then
        if ((line(2:3).eq.'g2').or.
     &      (line(2:3).eq.'b3').or.
     &      (line(2:3).eq.'b4')) then
          iedge=2
        else if ((line(2:3).eq.'g1').or.
     &           (line(2:3).eq.'b1')) then
          iedge=3
        else if ((line(2:3).eq.'b2').or.
     &           (line(2:3).eq.'a1')) then
          iedge=4
        endif
      else if (line(1:1).eq.'M') then
        if (line(2:2).eq.'1') iedge=5
        if (line(2:2).eq.'2') iedge=6
        if (line(2:2).eq.'g') iedge=7
        if (line(2:2).eq.'b') iedge=8
        if (line(2:2).eq.'a') iedge=9
      else if (line(1:1).eq.'N') then
        if (line(2:2).eq.'1') iedge=10
        if (line(2:2).eq.'2') iedge=11
        if (line(2:2).eq.'3') iedge=12
      endif
      if (j.le.10) then
        edge=x0(iedge,j)/1000.
      else if (j.le.20) then
        edge=x1(iedge,j-10)/1000.
      else if (j.le.30) then
        edge=x2(iedge,j-20)/1000.
      else if (j.le.40) then
        edge=x3(iedge,j-30)/1000.
      else if (j.le.50) then
        edge=x4(iedge,j-40)/1000.
      else if (j.le.60) then
        edge=x5(iedge,j-50)/1000.
      else if (j.le.70) then
        edge=x6(iedge,j-60)/1000.
      else if (j.le.80) then
        edge=x7(iedge,j-70)/1000.
      else if (j.le.90) then
        edge=x8(iedge,j-80)/1000.
      else
        edge=x9(iedge,j-90)/1000.
      endif
      if (edge.lt.0.) edge=50000.
      return
      end
