c---------------------------------EI--------------------------------cc     Exponential Integralc     This function calculates the exponential integral ei(x)c     for both positive and negative values of x.c     6/88 r.a. waldoc      function ei(x1)      real xiter(100)      data xiter/0.,     &.250000000000,.222222223878,.187500000000,.159999996424,     &.138888895512,.122448980808,.109375000000,.098765432835,     &.090000003576,.082644626498,.076388888061,.071005918086,     &.066326528788,.062222223729,.058593750000,.055363323539,     &.052469134331,.049861494452,.047499999404,.045351475477,     &.043388430029,.041587900370,.039930555969,.038400001824,     &.036982249469,.035665296018,.034438773990,.033293697983,     &.032222222537,.031217481941,.030273437500,.029384756461,     &.028546713293,.027755102143,.027006173506,.026296567172,     &.025623269379,.024983562529,.024374999106,.023795360699,     &.023242630064,.022714981809,.022210743278,.021728394553,     &.021266540512,.020823901519,.020399305969,.019991669804,     &.019600000232,.019223375246,.018860947341,.018511926755,     &.018175583333,.017851239070,.017538264394,.017236072570,     &.016944114119,.016661878675,.016388889402,.016124697402,     &.015868887305,.015621063299,.015380859375,.015147929080,     &.014921946451,.014702606015,.014489619061,.014282713644,     &.014081632718,.013886134140,.013695987873,.013510977849,     &.013330898248,.013155555353,.012984764762,.012818350457,     &.012656147592,.012497996911,.012343750335,.012193263508,     &.012046401389,.011903033592,.011763038114,.011626297608,     &.011492698453,.011362135410,.011234504171,.011109708808,     &.010987654328,.010868252255,.010751417838,.010637068190,     &.010525124148,.010415512137,.010308159515,.010202997364,     &.0100949958628,.009998979978,.009899999946/      x=x1      sign=1.      if (x.lt.0.) sign=-sign      if (x.lt.0.) x=-x      i=1      t=sign*x      ei=.5772156649+alog(x)+sign*x1     i=i+1      t=sign*x*t*xiter(i)      ei=ei+t      if (abs(t/ei).lt.1.e-12) return      goto 1      end