c      c     Returns unique filename based on time and date of openingc     Also asks if output should also be directed to a printerc     5/93 r.a. waldocc     pkc Modified by Carpenter 1994 to use only the console, no printercc      subroutine getfname(finame,printer)c     character*12 finame      character*1 printerc     character*2 cy1,cmo1,cd1,cm1c     character*1 ch1  c     Carpenter new time and date routines for gfortran      character*12 finame      character*8 date      character*10 time      character*2 c1, c2, c3      character*5 zone      integer, dimension(8) :: valuesc     using keyword arguments      call date_and_time(date,time,zone,values)      call date_and_time(DATE=date,ZONE=zone)      call date_and_time(TIME=time)      call date_and_time(VALUES=values)c     date gets '20160330' for march 30 2016c     time gets 190701.916 for 7:01:916c     date gets: 20160330  190701.916  -0500c     8 values are: 2016    3   30 -300   19    7    1  916c     values array  1       2   3   4     5     6    7   8c     print '(a,2x,a,2x,a)', date, time, zonec     print '(8i5)', valuesc     finame filename getsc     FIHHMMSS.txt, total length is 12      write(c1,fmt='(i2)') values(5)      write(c2,fmt='(i2)') values(6)        write(c3,fmt='(i2)') values(7)   c     File name concatenation      finame='FI'//c1//c2//c3//'.txt'c     pkc Carpenter the gettim and getdat calls are Intel time and date, not supportedc     by gfortranc     call gettim(ih,im,is,ihs)c     hours, minutes, seconds, hundredths of secsc     ih=0c     im=0c     is=0c     ihs=0c     call getdat(iy,imo,id)c     year, month, dayc     iy=0c     im=0c     id=0c     Here cy1 gets year, cmo1 gets month, cd1 gets day, cm1 gets minutec     and ch1 gets 64+hourc     iy2=mod(iy,100)c     write(cy1,fmt='(i2)') iy2c     write(cmo1,fmt='(i2)') imoc     write(cd1,fmt='(i2)') idc     write(cm1,fmt='(i2)') imc     ih2=64+ihc     write(ch1,fmt='(a1)') ih2c     File name is assembled from this informationc      finame='FI'//cy1//cmo1//cd1//'.'//ch1//cm1c      if (iy2.lt.10) finame(3:3)='0'c      if (imo.lt.10) finame(5:5)='0'c      if (id.lt.10) finame(7:7)='0'c      if (im.lt.10) finame(11:11)='0'c     Default printer selection is off (console only)      printer='S'      write(*,7002) finame 7002 format(' Results are automatically saved to ascii file "',a12,'"')c7002 format(' Results are automatically saved to ascii file "',a12,'";'c    &,/,' (i.e. to file FIyymmdd.hmm where yy-dd-mm hmm is the current'c    &,/,' date and time; h is the hour from A-X on a 24-hour clock.'c    &,//,' Direct output to Printer and CRT (P), or CRT only (S) Def.=Sc    &) ? ')c     pkc deactivated reading printer selectionc     read 990,printerc     if ((printer.eq.' ').or.(printer.eq.'s')) printer='S'c     if (printer.eq.'p') printer='P'c990   format(a1)      return      end